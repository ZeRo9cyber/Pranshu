<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register | ZeRo</title>

  <link rel="stylesheet" href="css/login.css">
  <link rel="stylesheet" href="css/style.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

<header>
  <div class="container">
    <nav>
      <div class="logo">
        <a href="index.html"><span>&lt;</span> ZeRo <span>/&gt;</span></a>
      </div>
      <ul class="nav-links">
        <li><a href="index.html#home">Home</a></li>
        <li><a href="index.html#about">About</a></li>
        <li><a href="index.html#contact">Contact</a></li>
      </ul>
    </nav>
  </div>
</header>

<video class="bg-video" autoplay muted loop playsinline>
  <source src="videos/cyber2.mp4" type="video/mp4">
</video>
<div class="video-overlay"></div>

<section class="login-hero">
  <div class="login-container">
    <div class="login-box">
      <h2>Create Account</h2>

      <input type="text" id="regName" placeholder="Full Name">
      <input type="email" id="regEmail" placeholder="Email">
      <input type="password" id="regPassword" placeholder="Password">
      <input type="password" id="regConfirm" placeholder="Confirm Password">

      <button onclick="registerUser()">Register</button>

      <p id="msg"></p>

      <p class="switch">
        Already have an account?
        <a href="login.html">Login</a>
      </p>
    </div>
  </div>
</section>

<!-- ✅ SUPABASE SDK (ONLY ONCE) -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="js/supabase-auth.js"></script>
<script src="js/auth.js"></script>


<script>
  /* ✅ SUPABASE CONFIG */
  const SUPABASE_URL = "https://caoyjwgzoubmajtlgshw.supabase.co";
  const SUPABASE_ANON_KEY =
    "sb_publishable_wsFdEb4PGNejNNgMGIBUhQ_fv0k2Awa";

  const supabaseClient = supabase.createClient(
    SUPABASE_URL,
    SUPABASE_ANON_KEY
  );

  /* ✅ REGISTER FUNCTION */
  async function registerUser() {
    const name = document.getElementById("regName").value.trim();
    const email = document.getElementById("regEmail").value.trim();
    const password = document.getElementById("regPassword").value;
    const confirm = document.getElementById("regConfirm").value;
    const msg = document.getElementById("msg");

    msg.style.color = "red";

    if (!name || !email || !password || !confirm) {
      msg.innerText = "All fields are required";
      return;
    }

    if (password.length < 6) {
      msg.innerText = "Password must be at least 6 characters";
      return;
    }

    if (password !== confirm) {
      msg.innerText = "Passwords do not match";
      return;
    }

    msg.innerText = "Creating account...";

    const { error } =
      await supabaseClient.auth.signUp({
        email,
        password,
        options: {
          data: { full_name: name },
          emailRedirectTo:
            "https://pranshu-09.vercel.app/login.html"
        }
      });

    if (error) {
      msg.innerText = error.message;
      return;
    }

    msg.style.color = "#3cf5ff";
    msg.innerText =
      "Verification email sent. Please check your inbox.";
  }

  // ✅ CONNECTION TEST
  (async () => {
    const { data, error } =
      await supabaseClient.auth.getSession();
    if (error) {
      console.log("❌ Supabase error", error);
    } else {
      console.log("✅ Supabase connected");
    }
  })();
</script>

</body>
</html>
